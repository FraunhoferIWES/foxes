Turbine 0, T0: kTI_02, TOYT
Turbine 1, T1: kTI_02, TOYT
Turbine 2, T2: kTI_02, TOYT
Turbine 3, T3: kTI_02, TOYT
Turbine 4, T4: kTI_02, TOYT
Turbine 5, T5: kTI_02, TOYT
Turbine 6, T6: kTI_02, TOYT
Turbine 7, T7: kTI_02, TOYT
Turbine 8, T8: kTI_02, TOYT
Turbine 9, T9: kTI_02, TOYT
Turbine 10, T10: kTI_02, TOYT
Turbine 11, T11: kTI_02, TOYT
Turbine 12, T12: kTI_02, TOYT
Turbine 13, T13: kTI_02, TOYT
Turbine 14, T14: kTI_02, TOYT
Turbine 15, T15: kTI_02, TOYT
Turbine 16, T16: kTI_02, TOYT
Turbine 17, T17: kTI_02, TOYT
Turbine 18, T18: kTI_02, TOYT
Turbine 19, T19: kTI_02, TOYT
Turbine 20, T20: kTI_02, TOYT
Turbine 21, T21: kTI_02, TOYT
Turbine 22, T22: kTI_02, TOYT
Turbine 23, T23: kTI_02, TOYT
Turbine 24, T24: kTI_02, TOYT
Turbine 25, T25: kTI_02, TOYT
Turbine 26, T26: kTI_02, TOYT
Turbine 27, T27: kTI_02, TOYT
Turbine 28, T28: kTI_02, TOYT
Turbine 29, T29: kTI_02, TOYT
Turbine 30, T30: kTI_02, TOYT
Turbine 31, T31: kTI_02, TOYT
Turbine 32, T32: kTI_02, TOYT
Turbine 33, T33: kTI_02, TOYT
Turbine 34, T34: kTI_02, TOYT
Turbine 35, T35: kTI_02, TOYT
Turbine 36, T36: kTI_02, TOYT
Turbine 37, T37: kTI_02, TOYT
Turbine 38, T38: kTI_02, TOYT
Turbine 39, T39: kTI_02, TOYT
Turbine 40, T40: kTI_02, TOYT
Turbine 41, T41: kTI_02, TOYT
Turbine 42, T42: kTI_02, TOYT
Turbine 43, T43: kTI_02, TOYT
Turbine 44, T44: kTI_02, TOYT
Turbine 45, T45: kTI_02, TOYT
Turbine 46, T46: kTI_02, TOYT
Turbine 47, T47: kTI_02, TOYT
Turbine 48, T48: kTI_02, TOYT
Turbine 49, T49: kTI_02, TOYT
Turbine 50, T50: kTI_02, TOYT
Turbine 51, T51: kTI_02, TOYT

--------------------------------------------------
  Running Downwind: calc_farm
--------------------------------------------------
  n_states  : 30
  n_turbines: 52
--------------------------------------------------
  states    : ScanWS
  rotor     : centre (CentreRotor)
  order     : order_wd (OrderWD)
  controller: basic_ctrl (BasicFarmController)
  partialwks: rotor_points (RotorPoints)
  wake frame: mean_wd (MeanFarmWind)
--------------------------------------------------
  wakes:
    0) Bastankhah_linear (BastankhahWake)
    1) CrespoHernandez_quadratic (CrespoHernandezTIWake)
--------------------------------------------------
  turbine models:
    0) kTI_02 (kTI)
    1) TOYT (PCtFile)
--------------------------------------------------
FarmDataModelList, sub-model 'set_xyhd': Initializing
FarmDataModelList, sub-model 'basic_ctrl': Initializing
FarmDataModelList, sub-model 'calc_yaw': Initializing
FarmDataModelList, sub-model 'centre': Initializing
FarmDataModelList, sub-model 'order_wd': Initializing
FarmDataModelList, sub-model 'set_amb_results': Initializing
FarmDataModelList, sub-model 'calc_wakes': Initializing

Input model data:

 <xarray.Dataset>
Dimensions:      (state: 30, turbine: 52, tmodels: 2)
Coordinates:
  * tmodels      (tmodels) <U6 'kTI_02' 'TOYT'
Dimensions without coordinates: state, turbine
Data variables:
    tmodel_sels  (state, turbine, tmodels) bool True True True ... True True
    weight       (state, turbine) float64 0.03333 0.03333 ... 0.03333 0.03333
    ScanWS_ws    (state) float64 3.0 3.414 3.828 4.241 ... 14.17 14.59 15.0 


Output farm variables: weight, X, Y, H, D, k, P, CT, WD, YAW, REWS, REWS2, REWS3, TI, RHO, order, AMB_P, AMB_CT, AMB_WD, AMB_YAW, AMB_REWS, AMB_REWS2, AMB_REWS3, AMB_TI, AMB_RHO 


Calculating 30 states for 52 turbines
CENTRE EVAL ['WD', 'YAW']
None
(1,) {'WS': (30, 52, 1), 'WD': (30, 52, 1), 'TI': (30, 52, 1), 'RHO': (30, 52, 1)}
CENTRE EVAL ['REWS', 'REWS2', 'REWS3', 'TI', 'RHO']
None
(1,) {'WS': (30, 52, 1), 'WD': (30, 52, 1), 'TI': (30, 52, 1), 'RHO': (30, 52, 1)}

DW WCALC OI 0
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 

DW CWAKE 0
ROTP CONTR Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -1.00110135, -0.67197628, -0.48271588,
       -0.3637186 , -0.28397122, -0.22789704, -0.18695864, -0.15615289,
       -0.1323879 , -0.11366841, -0.09865962, -0.08644103, -0.07636104,
       -0.06794785, -0.06085302, -0.05481467, -0.0496329 , -0.04515295,
       -0.04125353, -0.03783846, -0.03483069, -0.03216792, -0.02979932,
       -0.02768309, -0.0257846 , -0.02407496, -0.02252992, -0.02112902,
       -0.01985485, -0.01869258, -0.01762948, -0.01665457, -0.01575836,
       -0.01493261, -0.01417011, -0.01346456, -0.01281044, -0.01220285,
       -0.01163749, -0.01111054, -0.01061859, -0.0101586 , -0.00972787,
       -0.00932398, -0.00894472, -0.00858815, -0.00825248, -0.00793611,
       -0.0076376 , -0.00735561]), 'TI': array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0.])}
ROTP CONTR CrespoHernandez_quadratic
{'WS': array([ 0.        , -1.65665493, -1.00110135, -0.67197628, -0.48271588,
       -0.3637186 , -0.28397122, -0.22789704, -0.18695864, -0.15615289,
       -0.1323879 , -0.11366841, -0.09865962, -0.08644103, -0.07636104,
       -0.06794785, -0.06085302, -0.05481467, -0.0496329 , -0.04515295,
       -0.04125353, -0.03783846, -0.03483069, -0.03216792, -0.02979932,
       -0.02768309, -0.0257846 , -0.02407496, -0.02252992, -0.02112902,
       -0.01985485, -0.01869258, -0.01762948, -0.01665457, -0.01575836,
       -0.01493261, -0.01417011, -0.01346456, -0.01281044, -0.01220285,
       -0.01163749, -0.01111054, -0.01061859, -0.0101586 , -0.00972787,
       -0.00932398, -0.00894472, -0.00858815, -0.00825248, -0.00793611,
       -0.0076376 , -0.00735561]), 'TI': array([0.        , 0.0016035 , 0.00104676, 0.00080751, 0.00067172,
       0.00058233, 0.00051819, 0.00046951, 0.00043105, 0.00039975,
       0.00037369, 0.00035157, 0.00033253, 0.00031592, 0.00030129,
       0.00028828, 0.00027661, 0.00026608, 0.00025653, 0.0002478 ,
       0.0002398 , 0.00023243, 0.00022561, 0.00021928, 0.00021339,
       0.00020789, 0.00020273, 0.00019789, 0.00019334, 0.00018905,
       0.00018499, 0.00018115, 0.00017751, 0.00017404, 0.00017075,
       0.00016761, 0.00016462, 0.00016176, 0.00015902, 0.0001564 ,
       0.00015388, 0.00015147, 0.00014915, 0.00014692, 0.00014478,
       0.00014271, 0.00014072, 0.00013879, 0.00013693, 0.00013514,
       0.0001334 , 0.00013172])}

DW WCALC OI 1
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] 

DW EVAL 1
ROTP EVAL WRES A
WS [15.]
ROTP EVAL WRES A
WD [270.]
ROTP EVAL WRES A
TI [0.08]
ROTP EVAL WRES A
RHO [1.225]
ROTP EVAL WDEL
WS (30, 1) [ 0.         -1.65665493 -1.00110135 -0.67197628 -0.48271588 -0.3637186
 -0.28397122 -0.22789704 -0.18695864 -0.15615289 -0.1323879  -0.11366841
 -0.09865962 -0.08644103 -0.07636104 -0.06794785 -0.06085302 -0.05481467
 -0.0496329  -0.04515295 -0.04125353 -0.03783846 -0.03483069 -0.03216792
 -0.02979932 -0.02768309 -0.0257846  -0.02407496 -0.02252992 -0.02112902
 -0.01985485 -0.01869258 -0.01762948 -0.01665457 -0.01575836 -0.01493261
 -0.01417011 -0.01346456 -0.01281044 -0.01220285 -0.01163749 -0.01111054
 -0.01061859 -0.0101586  -0.00972787 -0.00932398 -0.00894472 -0.00858815
 -0.00825248 -0.00793611 -0.0076376  -0.00735561]
ROTP EVAL WDEL
TI (30, 1) [0.         0.0016035  0.00104676 0.00080751 0.00067172 0.00058233
 0.00051819 0.00046951 0.00043105 0.00039975 0.00037369 0.00035157
 0.00033253 0.00031592 0.00030129 0.00028828 0.00027661 0.00026608
 0.00025653 0.0002478  0.0002398  0.00023243 0.00022561 0.00021928
 0.00021339 0.00020789 0.00020273 0.00019789 0.00019334 0.00018905
 0.00018499 0.00018115 0.00017751 0.00017404 0.00017075 0.00016761
 0.00016462 0.00016176 0.00015902 0.0001564  0.00015388 0.00015147
 0.00014915 0.00014692 0.00014478 0.00014271 0.00014072 0.00013879
 0.00013693 0.00013514 0.0001334  0.00013172]
ROTP EVAL FLZ Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -1.00110135, -0.67197628, -0.48271588,
       -0.3637186 , -0.28397122, -0.22789704, -0.18695864, -0.15615289,
       -0.1323879 , -0.11366841, -0.09865962, -0.08644103, -0.07636104,
       -0.06794785, -0.06085302, -0.05481467, -0.0496329 , -0.04515295,
       -0.04125353, -0.03783846, -0.03483069, -0.03216792, -0.02979932,
       -0.02768309, -0.0257846 , -0.02407496, -0.02252992, -0.02112902,
       -0.01985485, -0.01869258, -0.01762948, -0.01665457, -0.01575836,
       -0.01493261, -0.01417011, -0.01346456, -0.01281044, -0.01220285,
       -0.01163749, -0.01111054, -0.01061859, -0.0101586 , -0.00972787,
       -0.00932398, -0.00894472, -0.00858815, -0.00825248, -0.00793611,
       -0.0076376 , -0.00735561]), 'TI': array([0.        , 0.0016035 , 0.00104676, 0.00080751, 0.00067172,
       0.00058233, 0.00051819, 0.00046951, 0.00043105, 0.00039975,
       0.00037369, 0.00035157, 0.00033253, 0.00031592, 0.00030129,
       0.00028828, 0.00027661, 0.00026608, 0.00025653, 0.0002478 ,
       0.0002398 , 0.00023243, 0.00022561, 0.00021928, 0.00021339,
       0.00020789, 0.00020273, 0.00019789, 0.00019334, 0.00018905,
       0.00018499, 0.00018115, 0.00017751, 0.00017404, 0.00017075,
       0.00016761, 0.00016462, 0.00016176, 0.00015902, 0.0001564 ,
       0.00015388, 0.00015147, 0.00014915, 0.00014692, 0.00014478,
       0.00014271, 0.00014072, 0.00013879, 0.00013693, 0.00013514,
       0.0001334 , 0.00013172])}
ROTP EVAL FLZ CrespoHernandez_quadratic
{'WS': array([ 0.        , -1.65665493, -1.00110135, -0.67197628, -0.48271588,
       -0.3637186 , -0.28397122, -0.22789704, -0.18695864, -0.15615289,
       -0.1323879 , -0.11366841, -0.09865962, -0.08644103, -0.07636104,
       -0.06794785, -0.06085302, -0.05481467, -0.0496329 , -0.04515295,
       -0.04125353, -0.03783846, -0.03483069, -0.03216792, -0.02979932,
       -0.02768309, -0.0257846 , -0.02407496, -0.02252992, -0.02112902,
       -0.01985485, -0.01869258, -0.01762948, -0.01665457, -0.01575836,
       -0.01493261, -0.01417011, -0.01346456, -0.01281044, -0.01220285,
       -0.01163749, -0.01111054, -0.01061859, -0.0101586 , -0.00972787,
       -0.00932398, -0.00894472, -0.00858815, -0.00825248, -0.00793611,
       -0.0076376 , -0.00735561]), 'TI': array([0.        , 0.0016035 , 0.00104676, 0.00080751, 0.00067172,
       0.00058233, 0.00051819, 0.00046951, 0.00043105, 0.00039975,
       0.00037369, 0.00035157, 0.00033253, 0.00031592, 0.00030129,
       0.00028828, 0.00027661, 0.00026608, 0.00025653, 0.0002478 ,
       0.0002398 , 0.00023243, 0.00022561, 0.00021928, 0.00021339,
       0.00020789, 0.00020273, 0.00019789, 0.00019334, 0.00018905,
       0.00018499, 0.00018115, 0.00017751, 0.00017404, 0.00017075,
       0.00016761, 0.00016462, 0.00016176, 0.00015902, 0.0001564 ,
       0.00015388, 0.00015147, 0.00014915, 0.00014692, 0.00014478,
       0.00014271, 0.00014072, 0.00013879, 0.00013693, 0.00013514,
       0.0001334 , 0.00013172])}
CENTRE EVAL ['REWS', 'REWS2', 'REWS3', 'TI', 'RHO']
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
(1,) {'WS': (30, 1, 1), 'WD': (30, 1, 1), 'TI': (30, 1, 1), 'RHO': (30, 1, 1)}
DW EVAL RESULT 1
[15.         13.34334507 15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.        ]
[0.08       0.08946231 0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08      ]
[0.016      0.01789246 0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016     ]
DW CWAKE 1
ROTP CONTR Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -3.00928267, -1.83728062, -1.2468186 ,
       -0.90421319, -0.68677635, -0.53980411, -0.4356737 , -0.35914286,
       -0.30121696, -0.25630002, -0.22075814, -0.19214626, -0.16876918,
       -0.14942107, -0.13322495, -0.11953045, -0.10784697, -0.09779865,
       -0.08909365, -0.0815025 , -0.07484278, -0.06896796, -0.06375927,
       -0.05911959, -0.05496891, -0.05124079, -0.04787973, -0.04483905,
       -0.04207925, -0.03956677, -0.03727289, -0.03517295, -0.0332457 ,
       -0.03147268, -0.02983786, -0.02832724, -0.02692855, -0.02563099,
       -0.02442503, -0.02330225, -0.02225518, -0.02127715, -0.02036221,
       -0.01950507, -0.01870094, -0.01794555, -0.01723503, -0.0165659 ,
       -0.015935  , -0.01533947]), 'TI': array([0.        , 0.0016035 , 0.00104676, 0.00080751, 0.00067172,
       0.00058233, 0.00051819, 0.00046951, 0.00043105, 0.00039975,
       0.00037369, 0.00035157, 0.00033253, 0.00031592, 0.00030129,
       0.00028828, 0.00027661, 0.00026608, 0.00025653, 0.0002478 ,
       0.0002398 , 0.00023243, 0.00022561, 0.00021928, 0.00021339,
       0.00020789, 0.00020273, 0.00019789, 0.00019334, 0.00018905,
       0.00018499, 0.00018115, 0.00017751, 0.00017404, 0.00017075,
       0.00016761, 0.00016462, 0.00016176, 0.00015902, 0.0001564 ,
       0.00015388, 0.00015147, 0.00014915, 0.00014692, 0.00014478,
       0.00014271, 0.00014072, 0.00013879, 0.00013693, 0.00013514,
       0.0001334 , 0.00013172])}
ROTP CONTR CrespoHernandez_quadratic
{'WS': array([ 0.        , -1.65665493, -3.00928267, -1.83728062, -1.2468186 ,
       -0.90421319, -0.68677635, -0.53980411, -0.4356737 , -0.35914286,
       -0.30121696, -0.25630002, -0.22075814, -0.19214626, -0.16876918,
       -0.14942107, -0.13322495, -0.11953045, -0.10784697, -0.09779865,
       -0.08909365, -0.0815025 , -0.07484278, -0.06896796, -0.06375927,
       -0.05911959, -0.05496891, -0.05124079, -0.04787973, -0.04483905,
       -0.04207925, -0.03956677, -0.03727289, -0.03517295, -0.0332457 ,
       -0.03147268, -0.02983786, -0.02832724, -0.02692855, -0.02563099,
       -0.02442503, -0.02330225, -0.02225518, -0.02127715, -0.02036221,
       -0.01950507, -0.01870094, -0.01794555, -0.01723503, -0.0165659 ,
       -0.015935  , -0.01533947]), 'TI': array([0.        , 0.0016035 , 0.00422092, 0.00284441, 0.00224306,
       0.00188943, 0.00165134, 0.00147786, 0.00134467, 0.00123854,
       0.00115157, 0.00107873, 0.00101666, 0.000963  , 0.00091605,
       0.00087456, 0.00083757, 0.00080434, 0.0007743 , 0.00074698,
       0.000722  , 0.00069905, 0.00067789, 0.00065829, 0.00064009,
       0.00062312, 0.00060726, 0.00059239, 0.00057843, 0.00056527,
       0.00055286, 0.00054112, 0.00053   , 0.00051945, 0.00050942,
       0.00049987, 0.00049077, 0.00048208, 0.00047378, 0.00046583,
       0.00045821, 0.00045091, 0.0004439 , 0.00043716, 0.00043067,
       0.00042443, 0.00041841, 0.00041261, 0.00040701, 0.0004016 ,
       0.00039637, 0.00039131])}

DW WCALC OI 2
[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2] 

DW EVAL 2
ROTP EVAL WRES A
WS [15.]
ROTP EVAL WRES A
WD [270.]
ROTP EVAL WRES A
TI [0.08]
ROTP EVAL WRES A
RHO [1.225]
ROTP EVAL WDEL
WS (30, 1) [ 0.         -1.65665493 -3.00928267 -1.83728062 -1.2468186  -0.90421319
 -0.68677635 -0.53980411 -0.4356737  -0.35914286 -0.30121696 -0.25630002
 -0.22075814 -0.19214626 -0.16876918 -0.14942107 -0.13322495 -0.11953045
 -0.10784697 -0.09779865 -0.08909365 -0.0815025  -0.07484278 -0.06896796
 -0.06375927 -0.05911959 -0.05496891 -0.05124079 -0.04787973 -0.04483905
 -0.04207925 -0.03956677 -0.03727289 -0.03517295 -0.0332457  -0.03147268
 -0.02983786 -0.02832724 -0.02692855 -0.02563099 -0.02442503 -0.02330225
 -0.02225518 -0.02127715 -0.02036221 -0.01950507 -0.01870094 -0.01794555
 -0.01723503 -0.0165659  -0.015935   -0.01533947]
ROTP EVAL WDEL
TI (30, 1) [0.         0.0016035  0.00422092 0.00284441 0.00224306 0.00188943
 0.00165134 0.00147786 0.00134467 0.00123854 0.00115157 0.00107873
 0.00101666 0.000963   0.00091605 0.00087456 0.00083757 0.00080434
 0.0007743  0.00074698 0.000722   0.00069905 0.00067789 0.00065829
 0.00064009 0.00062312 0.00060726 0.00059239 0.00057843 0.00056527
 0.00055286 0.00054112 0.00053    0.00051945 0.00050942 0.00049987
 0.00049077 0.00048208 0.00047378 0.00046583 0.00045821 0.00045091
 0.0004439  0.00043716 0.00043067 0.00042443 0.00041841 0.00041261
 0.00040701 0.0004016  0.00039637 0.00039131]
ROTP EVAL FLZ Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -3.00928267, -1.83728062, -1.2468186 ,
       -0.90421319, -0.68677635, -0.53980411, -0.4356737 , -0.35914286,
       -0.30121696, -0.25630002, -0.22075814, -0.19214626, -0.16876918,
       -0.14942107, -0.13322495, -0.11953045, -0.10784697, -0.09779865,
       -0.08909365, -0.0815025 , -0.07484278, -0.06896796, -0.06375927,
       -0.05911959, -0.05496891, -0.05124079, -0.04787973, -0.04483905,
       -0.04207925, -0.03956677, -0.03727289, -0.03517295, -0.0332457 ,
       -0.03147268, -0.02983786, -0.02832724, -0.02692855, -0.02563099,
       -0.02442503, -0.02330225, -0.02225518, -0.02127715, -0.02036221,
       -0.01950507, -0.01870094, -0.01794555, -0.01723503, -0.0165659 ,
       -0.015935  , -0.01533947]), 'TI': array([0.        , 0.0016035 , 0.00422092, 0.00284441, 0.00224306,
       0.00188943, 0.00165134, 0.00147786, 0.00134467, 0.00123854,
       0.00115157, 0.00107873, 0.00101666, 0.000963  , 0.00091605,
       0.00087456, 0.00083757, 0.00080434, 0.0007743 , 0.00074698,
       0.000722  , 0.00069905, 0.00067789, 0.00065829, 0.00064009,
       0.00062312, 0.00060726, 0.00059239, 0.00057843, 0.00056527,
       0.00055286, 0.00054112, 0.00053   , 0.00051945, 0.00050942,
       0.00049987, 0.00049077, 0.00048208, 0.00047378, 0.00046583,
       0.00045821, 0.00045091, 0.0004439 , 0.00043716, 0.00043067,
       0.00042443, 0.00041841, 0.00041261, 0.00040701, 0.0004016 ,
       0.00039637, 0.00039131])}
ROTP EVAL FLZ CrespoHernandez_quadratic
{'WS': array([ 0.        , -1.65665493, -3.00928267, -1.83728062, -1.2468186 ,
       -0.90421319, -0.68677635, -0.53980411, -0.4356737 , -0.35914286,
       -0.30121696, -0.25630002, -0.22075814, -0.19214626, -0.16876918,
       -0.14942107, -0.13322495, -0.11953045, -0.10784697, -0.09779865,
       -0.08909365, -0.0815025 , -0.07484278, -0.06896796, -0.06375927,
       -0.05911959, -0.05496891, -0.05124079, -0.04787973, -0.04483905,
       -0.04207925, -0.03956677, -0.03727289, -0.03517295, -0.0332457 ,
       -0.03147268, -0.02983786, -0.02832724, -0.02692855, -0.02563099,
       -0.02442503, -0.02330225, -0.02225518, -0.02127715, -0.02036221,
       -0.01950507, -0.01870094, -0.01794555, -0.01723503, -0.0165659 ,
       -0.015935  , -0.01533947]), 'TI': array([0.        , 0.0016035 , 0.00422092, 0.00284441, 0.00224306,
       0.00188943, 0.00165134, 0.00147786, 0.00134467, 0.00123854,
       0.00115157, 0.00107873, 0.00101666, 0.000963  , 0.00091605,
       0.00087456, 0.00083757, 0.00080434, 0.0007743 , 0.00074698,
       0.000722  , 0.00069905, 0.00067789, 0.00065829, 0.00064009,
       0.00062312, 0.00060726, 0.00059239, 0.00057843, 0.00056527,
       0.00055286, 0.00054112, 0.00053   , 0.00051945, 0.00050942,
       0.00049987, 0.00049077, 0.00048208, 0.00047378, 0.00046583,
       0.00045821, 0.00045091, 0.0004439 , 0.00043716, 0.00043067,
       0.00042443, 0.00041841, 0.00041261, 0.00040701, 0.0004016 ,
       0.00039637, 0.00039131])}
CENTRE EVAL ['REWS', 'REWS2', 'REWS3', 'TI', 'RHO']
[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
(1,) {'WS': (30, 1, 1), 'WD': (30, 1, 1), 'TI': (30, 1, 1), 'RHO': (30, 1, 1)}
DW EVAL RESULT 2
[15.         13.34334507 11.99071733 15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.        ]
[0.08       0.08946231 0.10305783 0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08       0.08       0.08
 0.08       0.08       0.08       0.08      ]
[0.016      0.01789246 0.02061157 0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016      0.016      0.016
 0.016      0.016      0.016      0.016     ]
DW CWAKE 2
ROTP CONTR Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -3.00928267, -4.16944098, -2.53422106,
       -1.7255693 , -1.25760975, -0.95997724, -0.75804323, -0.61437235,
       -0.50834075, -0.4277676 , -0.36505878, -0.31526948, -0.27506264,
       -0.24211759, -0.21477856, -0.19183777, -0.17239702, -0.15577688,
       -0.14145553, -0.12902677, -0.1181705 , -0.1086317 , -0.10020509,
       -0.09272395, -0.08605174, -0.08007571, -0.07470214, -0.06985259,
       -0.06546098, -0.06147135, -0.05783604, -0.05451426, -0.05147094,
       -0.04867577, -0.04610245, -0.04372811, -0.04153272, -0.03949873,
       -0.03761069, -0.03585495, -0.03421942, -0.03269337, -0.03126724,
       -0.02993248, -0.02868145, -0.02750728, -0.0264038 , -0.02536545,
       -0.02438719, -0.02346448]), 'TI': array([0.        , 0.0016035 , 0.00422092, 0.00284441, 0.00224306,
       0.00188943, 0.00165134, 0.00147786, 0.00134467, 0.00123854,
       0.00115157, 0.00107873, 0.00101666, 0.000963  , 0.00091605,
       0.00087456, 0.00083757, 0.00080434, 0.0007743 , 0.00074698,
       0.000722  , 0.00069905, 0.00067789, 0.00065829, 0.00064009,
       0.00062312, 0.00060726, 0.00059239, 0.00057843, 0.00056527,
       0.00055286, 0.00054112, 0.00053   , 0.00051945, 0.00050942,
       0.00049987, 0.00049077, 0.00048208, 0.00047378, 0.00046583,
       0.00045821, 0.00045091, 0.0004439 , 0.00043716, 0.00043067,
       0.00042443, 0.00041841, 0.00041261, 0.00040701, 0.0004016 ,
       0.00039637, 0.00039131])}
ROTP CONTR CrespoHernandez_quadratic
E
======================================================================
ERROR: test (__main__.Test)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "test_row_Bastankhah_Crespo.py", line 75, in test
    data = algo.calc_farm()
  File "/home/jonas/gitCFD/flap/foxes/foxes/algorithms/downwind/downwind.py", line 172, in calc_farm
    farm_results = mlist.run_calculation(self, models_data, parameters=calc_pars)
  File "/home/jonas/gitCFD/flap/foxes/foxes/core/farm_data_model.py", line 124, in run_calculation
    results = xr.apply_ufunc(
  File "/home/jonas/.venv/foxes/lib/python3.8/site-packages/xarray/core/computation.py", line 1159, in apply_ufunc
    return apply_dataarray_vfunc(
  File "/home/jonas/.venv/foxes/lib/python3.8/site-packages/xarray/core/computation.py", line 286, in apply_dataarray_vfunc
    result_var = func(*data_vars)
  File "/home/jonas/.venv/foxes/lib/python3.8/site-packages/xarray/core/computation.py", line 727, in apply_variable_ufunc
    result_data = func(*input_data)
  File "/home/jonas/gitCFD/flap/foxes/foxes/core/farm_data_model.py", line 58, in _wrap_calc
    results = self.calculate(algo, mdata, fdata, **calc_pars)
  File "/home/jonas/gitCFD/flap/foxes/foxes/core/farm_data_model_list.py", line 44, in calculate
    res = m.calculate(algo, mdata, fdata, **parameters[mi])
  File "/home/jonas/gitCFD/flap/foxes/foxes/algorithms/downwind/models/farm_wakes_calc.py", line 58, in calculate
    quit()
  File "/usr/lib/python3.8/_sitebuiltins.py", line 26, in __call__
    raise SystemExit(code)
SystemExit: None

----------------------------------------------------------------------
Ran 1 test in 0.024s

FAILED (errors=1)
{'WS': array([ 0.        , -1.65665493, -3.00928267, -4.16944098, -2.53422106,
       -1.7255693 , -1.25760975, -0.95997724, -0.75804323, -0.61437235,
       -0.50834075, -0.4277676 , -0.36505878, -0.31526948, -0.27506264,
       -0.24211759, -0.21477856, -0.19183777, -0.17239702, -0.15577688,
       -0.14145553, -0.12902677, -0.1181705 , -0.1086317 , -0.10020509,
       -0.09272395, -0.08605174, -0.08007571, -0.07470214, -0.06985259,
       -0.06546098, -0.06147135, -0.05783604, -0.05451426, -0.05147094,
       -0.04867577, -0.04610245, -0.04372811, -0.04153272, -0.03949873,
       -0.03761069, -0.03585495, -0.03421942, -0.03269337, -0.03126724,
       -0.02993248, -0.02868145, -0.02750728, -0.0264038 , -0.02536545,
       -0.02438719, -0.02346448]), 'TI': array([0.        , 0.0016035 , 0.00422092, 0.00900407, 0.0061958 ,
       0.00493872, 0.00418786, 0.00367681, 0.00330144, 0.00301148,
       0.00277929, 0.00258826, 0.00242775, 0.00229059, 0.00217173,
       0.00206754, 0.00197529, 0.00189292, 0.00181883, 0.00175175,
       0.00169068, 0.00163479, 0.00158341, 0.00153597, 0.00149202,
       0.00145116, 0.00141305, 0.0013774 , 0.00134398, 0.00131255,
       0.00128295, 0.001255  , 0.00122856, 0.0012035 , 0.00117971,
       0.00115709, 0.00113555, 0.00111501, 0.00109539, 0.00107664,
       0.00105869, 0.00104149, 0.00102498, 0.00100913, 0.00099389,
       0.00097923, 0.00096511, 0.0009515 , 0.00093837, 0.0009257 ,
       0.00091346, 0.00090162])}
