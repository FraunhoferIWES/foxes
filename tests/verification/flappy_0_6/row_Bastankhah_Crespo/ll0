Turbine 0, T0: kTI_02, TOYT
Turbine 1, T1: kTI_02, TOYT
Turbine 2, T2: kTI_02, TOYT
Turbine 3, T3: kTI_02, TOYT
Turbine 4, T4: kTI_02, TOYT
Turbine 5, T5: kTI_02, TOYT
Turbine 6, T6: kTI_02, TOYT
Turbine 7, T7: kTI_02, TOYT
Turbine 8, T8: kTI_02, TOYT
Turbine 9, T9: kTI_02, TOYT
Turbine 10, T10: kTI_02, TOYT
Turbine 11, T11: kTI_02, TOYT
Turbine 12, T12: kTI_02, TOYT
Turbine 13, T13: kTI_02, TOYT
Turbine 14, T14: kTI_02, TOYT
Turbine 15, T15: kTI_02, TOYT
Turbine 16, T16: kTI_02, TOYT
Turbine 17, T17: kTI_02, TOYT
Turbine 18, T18: kTI_02, TOYT
Turbine 19, T19: kTI_02, TOYT
Turbine 20, T20: kTI_02, TOYT
Turbine 21, T21: kTI_02, TOYT
Turbine 22, T22: kTI_02, TOYT
Turbine 23, T23: kTI_02, TOYT
Turbine 24, T24: kTI_02, TOYT
Turbine 25, T25: kTI_02, TOYT
Turbine 26, T26: kTI_02, TOYT
Turbine 27, T27: kTI_02, TOYT
Turbine 28, T28: kTI_02, TOYT
Turbine 29, T29: kTI_02, TOYT
Turbine 30, T30: kTI_02, TOYT
Turbine 31, T31: kTI_02, TOYT
Turbine 32, T32: kTI_02, TOYT
Turbine 33, T33: kTI_02, TOYT
Turbine 34, T34: kTI_02, TOYT
Turbine 35, T35: kTI_02, TOYT
Turbine 36, T36: kTI_02, TOYT
Turbine 37, T37: kTI_02, TOYT
Turbine 38, T38: kTI_02, TOYT
Turbine 39, T39: kTI_02, TOYT
Turbine 40, T40: kTI_02, TOYT
Turbine 41, T41: kTI_02, TOYT
Turbine 42, T42: kTI_02, TOYT
Turbine 43, T43: kTI_02, TOYT
Turbine 44, T44: kTI_02, TOYT
Turbine 45, T45: kTI_02, TOYT
Turbine 46, T46: kTI_02, TOYT
Turbine 47, T47: kTI_02, TOYT
Turbine 48, T48: kTI_02, TOYT
Turbine 49, T49: kTI_02, TOYT
Turbine 50, T50: kTI_02, TOYT
Turbine 51, T51: kTI_02, TOYT

--------------------------------------------------
  Running Downwind: calc_farm
--------------------------------------------------
  n_states  : 30
  n_turbines: 52
--------------------------------------------------
  states    : ScanWS
  rotor     : centre (CentreRotor)
  order     : order_wd (OrderWD)
  controller: basic_ctrl (BasicFarmController)
  partialwks: rotor_points (RotorPoints)
  wake frame: mean_wd (MeanFarmWind)
--------------------------------------------------
  wakes:
    0) Bastankhah_linear (BastankhahWake)
--------------------------------------------------
  turbine models:
    0) kTI_02 (kTI)
    1) TOYT (PCtFile)
--------------------------------------------------
FarmDataModelList, sub-model 'set_xyhd': Initializing
FarmDataModelList, sub-model 'basic_ctrl': Initializing
FarmDataModelList, sub-model 'calc_yaw': Initializing
FarmDataModelList, sub-model 'centre': Initializing
FarmDataModelList, sub-model 'order_wd': Initializing
FarmDataModelList, sub-model 'set_amb_results': Initializing
FarmDataModelList, sub-model 'calc_wakes': Initializing

Input model data:

 <xarray.Dataset>
Dimensions:      (state: 30, turbine: 52, tmodels: 2)
Coordinates:
  * tmodels      (tmodels) <U6 'kTI_02' 'TOYT'
Dimensions without coordinates: state, turbine
Data variables:
    tmodel_sels  (state, turbine, tmodels) bool True True True ... True True
    weight       (state, turbine) float64 0.03333 0.03333 ... 0.03333 0.03333
    ScanWS_ws    (state) float64 3.0 3.414 3.828 4.241 ... 14.17 14.59 15.0 


Output farm variables: weight, X, Y, H, D, k, P, CT, WD, YAW, REWS, REWS2, REWS3, TI, RHO, order, AMB_P, AMB_CT, AMB_WD, AMB_YAW, AMB_REWS, AMB_REWS2, AMB_REWS3, AMB_TI, AMB_RHO 


Calculating 30 states for 52 turbines
CENTRE EVAL ['WD', 'YAW']
None
(1,) {'WS': (30, 52, 1), 'WD': (30, 52, 1), 'TI': (30, 52, 1), 'RHO': (30, 52, 1)}
CENTRE EVAL ['REWS', 'REWS2', 'REWS3', 'TI', 'RHO']
None
(1,) {'WS': (30, 52, 1), 'WD': (30, 52, 1), 'TI': (30, 52, 1), 'RHO': (30, 52, 1)}

DW WCALC OI 0
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] 

DW CWAKE 0
ROTP CONTR Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -1.00110135, -0.67197628, -0.48271588,
       -0.3637186 , -0.28397122, -0.22789704, -0.18695864, -0.15615289,
       -0.1323879 , -0.11366841, -0.09865962, -0.08644103, -0.07636104,
       -0.06794785, -0.06085302, -0.05481467, -0.0496329 , -0.04515295,
       -0.04125353, -0.03783846, -0.03483069, -0.03216792, -0.02979932,
       -0.02768309, -0.0257846 , -0.02407496, -0.02252992, -0.02112902,
       -0.01985485, -0.01869258, -0.01762948, -0.01665457, -0.01575836,
       -0.01493261, -0.01417011, -0.01346456, -0.01281044, -0.01220285,
       -0.01163749, -0.01111054, -0.01061859, -0.0101586 , -0.00972787,
       -0.00932398, -0.00894472, -0.00858815, -0.00825248, -0.00793611,
       -0.0076376 , -0.00735561])}

DW WCALC OI 1
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] 

DW EVAL 1
ROTP EVAL WRES A
WS [15.]
ROTP EVAL WRES A
WD [270.]
ROTP EVAL WRES A
TI [0.08]
ROTP EVAL WRES A
RHO [1.225]
ROTP EVAL WDEL
WS (30, 1) [ 0.         -1.65665493 -1.00110135 -0.67197628 -0.48271588 -0.3637186
 -0.28397122 -0.22789704 -0.18695864 -0.15615289 -0.1323879  -0.11366841
 -0.09865962 -0.08644103 -0.07636104 -0.06794785 -0.06085302 -0.05481467
 -0.0496329  -0.04515295 -0.04125353 -0.03783846 -0.03483069 -0.03216792
 -0.02979932 -0.02768309 -0.0257846  -0.02407496 -0.02252992 -0.02112902
 -0.01985485 -0.01869258 -0.01762948 -0.01665457 -0.01575836 -0.01493261
 -0.01417011 -0.01346456 -0.01281044 -0.01220285 -0.01163749 -0.01111054
 -0.01061859 -0.0101586  -0.00972787 -0.00932398 -0.00894472 -0.00858815
 -0.00825248 -0.00793611 -0.0076376  -0.00735561]
ROTP EVAL FLZ Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -1.00110135, -0.67197628, -0.48271588,
       -0.3637186 , -0.28397122, -0.22789704, -0.18695864, -0.15615289,
       -0.1323879 , -0.11366841, -0.09865962, -0.08644103, -0.07636104,
       -0.06794785, -0.06085302, -0.05481467, -0.0496329 , -0.04515295,
       -0.04125353, -0.03783846, -0.03483069, -0.03216792, -0.02979932,
       -0.02768309, -0.0257846 , -0.02407496, -0.02252992, -0.02112902,
       -0.01985485, -0.01869258, -0.01762948, -0.01665457, -0.01575836,
       -0.01493261, -0.01417011, -0.01346456, -0.01281044, -0.01220285,
       -0.01163749, -0.01111054, -0.01061859, -0.0101586 , -0.00972787,
       -0.00932398, -0.00894472, -0.00858815, -0.00825248, -0.00793611,
       -0.0076376 , -0.00735561])}
CENTRE EVAL ['REWS', 'REWS2', 'REWS3', 'TI', 'RHO']
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
(1,) {'WS': (30, 1, 1), 'WD': (30, 1, 1), 'TI': (30, 1, 1), 'RHO': (30, 1, 1)}
DW EVAL RESULT 1
[15.         13.34334507 15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.        ]
[0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08
 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08
 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08
 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08]
[0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016]
DW CWAKE 1
ROTP CONTR Bastankhah_linear
E
======================================================================
ERROR: test (__main__.Test)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "test_row_Bastankhah_Crespo.py", line 75, in test
    data = algo.calc_farm()
  File "/home/jonas/gitCFD/flap/foxes/foxes/algorithms/downwind/downwind.py", line 172, in calc_farm
    farm_results = mlist.run_calculation(self, models_data, parameters=calc_pars)
  File "/home/jonas/gitCFD/flap/foxes/foxes/core/farm_data_model.py", line 124, in run_calculation
    results = xr.apply_ufunc(
  File "/home/jonas/.venv/foxes/lib/python3.8/site-packages/xarray/core/computation.py", line 1159, in apply_ufunc
    return apply_dataarray_vfunc(
  File "/home/jonas/.venv/foxes/lib/python3.8/site-packages/xarray/core/computation.py", line 286, in apply_dataarray_vfunc
    result_var = func(*data_vars)
  File "/home/jonas/.venv/foxes/lib/python3.8/site-packages/xarray/core/computation.py", line 727, in apply_variable_ufunc
    result_data = func(*input_data)
  File "/home/jonas/gitCFD/flap/foxes/foxes/core/farm_data_model.py", line 58, in _wrap_calc
    results = self.calculate(algo, mdata, fdata, **calc_pars)
  File "/home/jonas/gitCFD/flap/foxes/foxes/core/farm_data_model_list.py", line 44, in calculate
    res = m.calculate(algo, mdata, fdata, **parameters[mi])
  File "/home/jonas/gitCFD/flap/foxes/foxes/algorithms/downwind/models/farm_wakes_calc.py", line 58, in calculate
    quit()
  File "/usr/lib/python3.8/_sitebuiltins.py", line 26, in __call__
    raise SystemExit(code)
SystemExit: None

----------------------------------------------------------------------
Ran 1 test in 0.017s

FAILED (errors=1)
{'WS': array([ 0.        , -1.65665493, -3.15116115, -1.96322848, -1.34782459,
       -0.98484027, -0.75196287, -0.59334252, -0.48031621, -0.39688034,
       -0.33350634, -0.28422454, -0.24513657, -0.21360735, -0.18780289,
       -0.16641444, -0.14848747, -0.13331244, -0.12035294, -0.1091973 ,
       -0.0995253 , -0.09108481, -0.08367514, -0.07713487, -0.07133303,
       -0.06616243, -0.06153465, -0.05737624, -0.05362577, -0.05023156,
       -0.04714984, -0.04434339, -0.04178035, -0.03943336, -0.03727879,
       -0.03529617, -0.03346766, -0.03177768, -0.0302126 , -0.02876038,
       -0.02741044, -0.02615339, -0.02498088, -0.02388552, -0.02286067,
       -0.0219004 , -0.02099941, -0.0201529 , -0.01935658, -0.01860655,
       -0.01789929, -0.01723161])}

DW WCALC OI 2
[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2] 

DW EVAL 2
ROTP EVAL WRES A
WS [15.]
ROTP EVAL WRES A
WD [270.]
ROTP EVAL WRES A
TI [0.08]
ROTP EVAL WRES A
RHO [1.225]
ROTP EVAL WDEL
WS (30, 1) [ 0.         -1.65665493 -3.15116115 -1.96322848 -1.34782459 -0.98484027
 -0.75196287 -0.59334252 -0.48031621 -0.39688034 -0.33350634 -0.28422454
 -0.24513657 -0.21360735 -0.18780289 -0.16641444 -0.14848747 -0.13331244
 -0.12035294 -0.1091973  -0.0995253  -0.09108481 -0.08367514 -0.07713487
 -0.07133303 -0.06616243 -0.06153465 -0.05737624 -0.05362577 -0.05023156
 -0.04714984 -0.04434339 -0.04178035 -0.03943336 -0.03727879 -0.03529617
 -0.03346766 -0.03177768 -0.0302126  -0.02876038 -0.02741044 -0.02615339
 -0.02498088 -0.02388552 -0.02286067 -0.0219004  -0.02099941 -0.0201529
 -0.01935658 -0.01860655 -0.01789929 -0.01723161]
ROTP EVAL FLZ Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -3.15116115, -1.96322848, -1.34782459,
       -0.98484027, -0.75196287, -0.59334252, -0.48031621, -0.39688034,
       -0.33350634, -0.28422454, -0.24513657, -0.21360735, -0.18780289,
       -0.16641444, -0.14848747, -0.13331244, -0.12035294, -0.1091973 ,
       -0.0995253 , -0.09108481, -0.08367514, -0.07713487, -0.07133303,
       -0.06616243, -0.06153465, -0.05737624, -0.05362577, -0.05023156,
       -0.04714984, -0.04434339, -0.04178035, -0.03943336, -0.03727879,
       -0.03529617, -0.03346766, -0.03177768, -0.0302126 , -0.02876038,
       -0.02741044, -0.02615339, -0.02498088, -0.02388552, -0.02286067,
       -0.0219004 , -0.02099941, -0.0201529 , -0.01935658, -0.01860655,
       -0.01789929, -0.01723161])}
CENTRE EVAL ['REWS', 'REWS2', 'REWS3', 'TI', 'RHO']
[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
(1,) {'WS': (30, 1, 1), 'WD': (30, 1, 1), 'TI': (30, 1, 1), 'RHO': (30, 1, 1)}
DW EVAL RESULT 2
[15.         13.34334507 11.84883885 15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.         15.         15.
 15.         15.         15.         15.        ]
[0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08
 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08
 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08
 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08]
[0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016 0.016
 0.016 0.016 0.016 0.016]
DW CWAKE 2
ROTP CONTR Bastankhah_linear
{'WS': array([ 0.        , -1.65665493, -3.15116115, -4.82986299, -3.05428394,
       -2.12634697, -1.57177031, -1.2115526 , -0.96353166, -0.78514791,
       -0.65240208, -0.5508685 , -0.47142965, -0.40808368, -0.35674405,
       -0.31454786, -0.27943978, -0.24991268, -0.22484064, -0.2033686 ,
       -0.18483761, -0.16873313, -0.1546486 , -0.14225931, -0.13130336,
       -0.12156759, -0.11287711, -0.10508728, -0.09807771, -0.09174745,
       -0.0860114 , -0.08079739, -0.07604389, -0.07169819, -0.0677149 ,
       -0.06405479, -0.0606838 , -0.05757224, -0.05469414, -0.05202671,
       -0.04954986, -0.04724586, -0.04509897, -0.04309523, -0.04122218,
       -0.03946869, -0.0378248 , -0.03628155, -0.03483089, -0.03346556,
       -0.03217899, -0.03096524])}
